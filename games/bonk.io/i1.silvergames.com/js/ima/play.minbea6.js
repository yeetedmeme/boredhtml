var adsManager;var adsLoader;var adDisplayContainer;var intervalTimer;var playButton;var delay=0;var adslot_width;var adslot_height;var ad_type="skippablevideo_image_text";var ad_type_novideo="image_text";var ad_container="ima";var game_container="game_embed";var description_url=document.location;var language="";function showPreRoll(){adslot_width=document.getElementById(game_container).clientWidth;adslot_height=document.getElementById(game_container).clientHeight;language=document.documentElement.lang;setUpIMA()}function showPreRollNovideo(){ad_type=ad_type_novideo;showPreRoll()}function setUpIMA(){if(!createAdDisplayContainer()){killIMA();return}adsLoader=new google.ima.AdsLoader(adDisplayContainer);adsLoader.addEventListener(google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,onAdsManagerLoaded,false);adsLoader.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,onAdError,false);var a=new google.ima.AdsRequest();a.adTagUrl="https://googleads.g.doubleclick.net/pagead/ads?ad_type="+ad_type+"&client=ca-games-pub-9298242687620115&description_url="+encodeURI(description_url)+"&hl="+language;a.linearAdSlotWidth=adslot_width;a.linearAdSlotHeight=adslot_height;a.nonLinearAdSlotWidth=adslot_width;a.nonLinearAdSlotHeight=adslot_height;a.forceNonLinearFullSlot=true;adsLoader.requestAds(a)}function createAdDisplayContainer(){if(typeof google!=="undefined"){$("#game_embed_button_icon").hide();adDisplayContainer=new google.ima.AdDisplayContainer(document.getElementById(ad_container));return true}else{return false}}function playAds(){adDisplayContainer.initialize();try{adsManager.init(adslot_width,adslot_height,google.ima.ViewMode.NORMAL);adsManager.start()}catch(a){}}function onAdsManagerLoaded(b){var a=new google.ima.AdsRenderingSettings();a.restoreCustomPlaybackStateOnAdBreakComplete=true;adsManager=b.getAdsManager(adDisplayContainer,a);adsManager.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,onAdError);adsManager.addEventListener(google.ima.AdEvent.Type.ALL_ADS_COMPLETED,onAdEvent);adsManager.addEventListener(google.ima.AdEvent.Type.LOADED,onAdEvent);adsManager.addEventListener(google.ima.AdEvent.Type.STARTED,onAdEvent);adsManager.addEventListener(google.ima.AdEvent.Type.COMPLETE,onAdEvent);adsManager.addEventListener(google.ima.AdEvent.Type.SKIPPED,onAdEvent);adsManager.addEventListener(google.ima.AdEvent.Type.USER_CLOSE,onAdEvent);setTimeout(function(){playAds()},delay)}function onAdEvent(a){var b=a.getAd();switch(a.type){case google.ima.AdEvent.Type.LOADED:if(!b.isLinear()){}break;case google.ima.AdEvent.Type.STARTED:if(b.isLinear()){intervalTimer=setInterval(function(){var c=adsManager.getRemainingTime()},300)}break;case google.ima.AdEvent.Type.USER_CLOSE:case google.ima.AdEvent.Type.SKIPPED:case google.ima.AdEvent.Type.COMPLETE:if(b.isLinear()){clearInterval(intervalTimer)}adDone();break}}function onAdError(a){console.log(a.getError());adDone()}function adDone(){if(adsManager){adsManager.destroy()}document.getElementById(ad_container).outerHTML="";startGame()}function killIMA(){document.getElementById(ad_container).outerHTML="";startGame()}